<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" xmlns:b="http://bootsfaces.net/ui">
<h:head>
	<!-- Custom styles for this template -->
</h:head>
<h:body>
	<ui:composition template="/template.xhtml">
		<ui:define name="content">
			<!-- Archivliste -->
			<div class="col-md-3 hidden-xs hidden-sm column">
				<!-- Filter -->
				<div class="panel panel-default artikelPanel">
					<div class="panel-heading">
						<div class="pull-left schrift">
							<p:outputLabel rendered="#{data.filtergruppe.firmenGruppe}"
								value="#{data.filtergruppe.firma.name}" style="color: blue;"></p:outputLabel>
							<p:outputLabel rendered="#{data.filtergruppe.nutzerGruppe}"
								value="Private Filtergruppe" style="color: green;"></p:outputLabel>
							<h4>#{data.filtergruppe.titel}</h4>
						</div>

						<!-- Filter bearbeiten -->
						<b:form>
							<p:commandLink id="filter-bearbeiten"
								action="/filterbearbeiten.xhtml?faces-redirect=true">
								<!-- <f:param name="filterprofile" value="#{firmen.ausgewaehlteFirma.filterprofile}" />	
								<f:param name="filtergruppe" value="#{gruppe}" /> -->
								<f:actionListener for="filter-bearbeiten"
									binding="#{filterbearbeiten.setParameter(data.filtergruppe, data.filtergruppe.firmenGruppe ? data.filtergruppe.firma.filterprofile : data.nutzer.filterprofile)}" />
								<p:graphicImage value="/resources/image/edit-square.svg"
									class="pull-right bild" />
							</p:commandLink>
						</b:form>
						<div class="clearfix"></div>

					</div>

					<div class="panel-body filter">
						<h:form>
							<h4>Filter</h4>
							<div class="form-group">
								<b:dateTimePicker value="#{archiv.abZeitpunkt}" label="Frühste"
									mode="popup" show-time="false" render-label="true" />
							</div>
							<div class="form-group">
								<b:dateTimePicker value="#{archiv.bisZeitpunkt}"
									label="Späteste" mode="popup" show-time="false"
									render-label="true" />
							</div>
						</h:form>
					</div>
					<hr />
					
					<!-- manuellen Crawlvorgang starten -->
					<h:form id="manueller-crawl-form">
						<b:commandButton value="Jetzt Crawlen"
							action="#{archiv.manuellCrawlen()}" />
					</h:form>
					<hr />
					<div>
						<p:dataList class="list-group archiveintraege"
							value="#{archiv.archiveintraege}" var="eintrag" type="definition">
							<h:form>
								<p:commandLink class="list-group-item" id="ajax"
									update="artikelBereich"
									action="#{archiv.buttonAction(eintrag)}">
									<h:outputText value="#{eintrag.erstellungsdatum}">
										<f:convertDateTime type="date" pattern="dd.MM.yyyy" />
									</h:outputText>
								</p:commandLink>
							</h:form>
						</p:dataList>
					</div>
				</div>
			</div>

			<!-- Ausgewaehltes Archiv -->

			<b:modal id="artikel-modal" title="#{archiv.geweahlterArtikel.titel}"
				styleClass="modalPseudoClass">
				<div id="artikel-inhalt">
					<p:repeat value="#{archiv.geweahlterArtikel.absaetzeArtikel}"
						var="absatz">
						<p>#{absatz}"</p>
					</p:repeat>
				</div>

			</b:modal>

			<div class="col-md-9 column">
				<!-- Archiv -->

				<h:form class="panel panel-default artikelPanel" id="artikelBereich">
					<div class="panel-heading">
						<h3 class="panel-title pull-left linkeUeberschrift">
							Pressespiegel vom
							<h:outputText
								value="#{archiv.geweahlterArchiveintrag.erstellungsdatum}">
								<f:convertDateTime type="date" pattern="dd.MM.yyyy" />
							</h:outputText>
						</h3>
						<div class="btn-group pull-right" role="group">
							<b:commandButton type="button" value="PDF exportieren"
								action="#{archiv.exportierePdf()}" class="btn btn-default" />
							<b:commandButton type="button" value="Eintrag löschen"
								action="#{archiv.loescheArchiveintrag()}"
								class="btn btn-default" />
						</div>
						<div class="clearfix"></div>
					</div>


					<p:dataList class="list-group artikel"
						value="#{archiv.geweahlterArchiveintrag.artikel}" var="artikel"
						type="definition">
						<div class="list-group-item">

							<div class="artikel-titel-container">
								<h4 class="pull-left">#{artikel.titel}</h4>
								<p class="pull-right">
									Erschienen am
									<h:outputText value="#{artikel.erstellungsdatum}">
										<f:convertDateTime type="date" pattern="dd.MM.yyyy hh:mm" />
									</h:outputText>
								</p>
							</div>

							<p id="artikel-zusammenfassung">#{artikel.beschreibung}</p>

							<div class="artikel-titel-container">
								<h5 class="pull-left">#{artikel.autor}</h5>
								<div class="btn-group pull-right" role="group">
									<p:commandLink type="button" id="artikel-oeffnen-button"
										class="btn btn-default" update="artikel-modal"
										oncomplete="$('.modalPseudoClass').modal();return false;"
										value="Artikel ansehen">
										<f:actionListener for="artikel-oeffnen-button"
											binding="#{archiv.setGeweahlterArtikel(artikel)}"></f:actionListener>
									</p:commandLink>
									<p:link href="#{artikel.link}" type="button"
										class="btn btn-default" value="Website öffnen" />
								</div>
							</div>
						</div>

					</p:dataList>

				</h:form>
			</div>

		<!-- Footer -->
		</ui:define>
		<ui:define name="footer">

		</ui:define>
	</ui:composition>
</h:body>
</html>
